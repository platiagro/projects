spec:
  containers:
  - image: "{{ image }}"
    name: "{{ operator_id }}"
    securityContext:
      allowPrivilegeEscalation: "false"
      runAsUser: 0
    env:
    - name: "EXPERIMENT_ID"
      value: "{{ experiment_id }}"
    - name: "OPERATOR_ID"
      value: "{{ operator_id }}"
    - name: "TASK_NAME"
      value: "{{ task_name }}"
    - name: "NVIDIA_VISIBLE_DEVICES"
      value: "{{ nvidia_visible_devices }}"
    - name: "MINIO_ENDPOINT"
      value: "minio.platiagro:9000"
    - name: "MINIO_ACCESS_KEY"
      valueFrom:
        secretKeyRef:
          name: "minio-secrets"
          key: "MINIO_ACCESS_KEY"
    - name: "MINIO_SECRET_KEY"
      valueFrom:
        secretKeyRef:
          name: "minio-secrets"
          key: "MINIO_SECRET_KEY"
    volumeMounts:
    - name: "workspace"
      mountPath: "/app"
    resources:
      requests:
          memory: "{{ memory_request }}"
      limits:
          memory: "{{ memory_limit }}"
  volumes:
  - name: "workspace"
    persistentVolumeClaim:
        claimName: "vol-task-{{ task_id }}""
