apiVersion: argoproj.io/v1alpha1
kind: Workflow
metadata:
  generateName: deployment-f7771351-c8ce-48bc-bfe7-8dde255a3850-
  annotations:
    pipelines.kubeflow.org/pipeline_spec: '{"name": "deployment-f7771351-c8ce-48bc-bfe7-8dde255a3850-"}'
spec:
  arguments: {}
  entrypoint: deployment-f7771351-c8ce-48bc-bfe7-8dde255a3850
  serviceAccountName: pipeline-runner
  templates:
    - name: deployment-f7771351-c8ce-48bc-bfe7-8dde255a3850
      dag:
        tasks:
          - name: deployment
            template: deployment
            dependencies: []
            arguments: {}
      metadata:
        annotations:
          sidecar.istio.io/inject: "false"
    - name: deployment
      activeDeadlineSeconds: 300
      inputs: {}
      metadata:
        annotations:
          sidecar.istio.io/inject: "false"
      outputs:
        parameters:
        - name: deployment-manifest
          valueFrom:
            jsonPath: '{}'
        - name: deployment-name
          valueFrom:
            jsonPath: '{.metadata.name}'
      resource:
        action: create
        manifest: |
          apiVersion: machinelearning.seldon.io/v1alpha2
          kind: SeldonDeployment
          metadata:
            labels:
              app: seldon
            name: f7771351-c8ce-48bc-bfe7-8dde255a3850
          spec:
            annotations:
              deployment_version: v1
              prometheus.io/scrape: 'false'
              seldon.io/executor: 'true'
            name: f7771351-c8ce-48bc-bfe7-8dde255a3850
            predictors:
            - annotations:
                sidecar.istio.io/inject: 'false'
              componentSpecs:
              - spec:
                  containers:
                  - env:
                    - name: EXPERIMENT_ID
                      value: e6f52fe2-a4a1-42bc-9aeb-ef0735fa3468
                    - name: OPERATOR_ID
                      value: f6302be7-57a1-4a72-8652-c55611a6ad32
                    - name: TASK_NAME
                      value: "foo"
                    - name: LOG_LEVEL
                      value: DEBUG
                    image: seldonio/mock_classifier:1.5.0-dev
                    name: f6302be7-57a1-4a72-8652-c55611a6ad32
                    securityContext:
                      allowPrivilegeEscalation: false
                      runAsUser: 0
              graph:
                children: []
                name: f6302be7-57a1-4a72-8652-c55611a6ad32
                type: MODEL
              labels:
                version: v1
              name: model
              replicas: 1
              svcOrchSpec:
                env:
                - name: SELDON_LOG_LEVEL
                  value: INFO
        successCondition: status.state == Available
